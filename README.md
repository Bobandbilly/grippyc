I know this code is dog, but it works (bearly). 
Dont think about it too hard.
